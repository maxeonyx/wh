<Window x:Class="wh.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="wh - Whisper HUD" Width="360" Height="234"
        WindowStyle="None" ResizeMode="NoResize"
        AllowsTransparency="True" Background="Transparent"
        WindowStartupLocation="Manual"
        ShowInTaskbar="False" ShowActivated="False" Topmost="True">

    <Window.Resources>
        <SolidColorBrush x:Key="BodyBrush"   Color="#2B2C2C"/>
        <SolidColorBrush x:Key="HeaderBrush" Color="#262626"/>
        <SolidColorBrush x:Key="RingBrush"   Color="#2F2F2F"/>
        <SolidColorBrush x:Key="GlyphBrush"  Color="#E6E6E6"/>
        <SolidColorBrush x:Key="AccentBrush" Color="#546E74"/>

        <Style x:Key="IconButton" TargetType="Button">
            <Setter Property="Width" Value="36"/>
            <Setter Property="Height" Value="36"/>
            <Setter Property="Padding" Value="8"/>
            <Setter Property="Background" Value="{StaticResource BodyBrush}"/>
            <Setter Property="BorderBrush" Value="{StaticResource RingBrush}"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border CornerRadius="18"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                            <ContentPresenter HorizontalAlignment="Center"
                                              VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="BorderBrush" Value="#5A5A5A"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#232323"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Border CornerRadius="10" Background="{StaticResource BodyBrush}">
        <Border.Effect>
            <DropShadowEffect Color="#000000" BlurRadius="16" ShadowDepth="4" Opacity="0.5"/>
        </Border.Effect>

        <Grid Margin="6">
            <Grid.RowDefinitions>
                <RowDefinition Height="24"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <Border Grid.Row="0" Background="{StaticResource HeaderBrush}"
                    CornerRadius="8,8,0,0" MouseDown="Header_MouseDown">
                <Grid>
                    <Rectangle Width="40" Height="4" RadiusX="2" RadiusY="2"
                               Fill="#3B3B3B" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    <Button Width="20" Height="20" Padding="0" Background="Transparent"
                            BorderThickness="0" Foreground="{StaticResource GlyphBrush}"
                            HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,0,2,0"
                            ToolTip="Close" Click="Close_Click">
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE10A;" FontSize="12"/>
                    </Button>
                </Grid>
            </Border>

            <!-- Body -->
            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Left: Settings -->
                <Button Grid.Column="0" Style="{StaticResource IconButton}" ToolTip="Settings"
                        HorizontalAlignment="Center" VerticalAlignment="Center">
                    <Viewbox Stretch="Uniform">
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE713;"
                                   Foreground="{StaticResource GlyphBrush}"/>
                    </Viewbox>
                </Button>

                <!-- Center: Microphone -->
                <Grid Grid.Column="1" Width="96" Height="96" Margin="24,0"
                      HorizontalAlignment="Center" VerticalAlignment="Center">
                    <Ellipse Stroke="{StaticResource RingBrush}" StrokeThickness="4"
                             Fill="{StaticResource BodyBrush}"/>
                    <Viewbox>
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE720;"
                                   Foreground="{StaticResource AccentBrush}"/>
                    </Viewbox>
                </Grid>

                <!-- Right: Help -->
                <Button Grid.Column="2" Style="{StaticResource IconButton}" ToolTip="Help"
                        HorizontalAlignment="Center" VerticalAlignment="Center">
                    <Viewbox Stretch="Uniform">
                        <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE897;"
                                   Foreground="{StaticResource GlyphBrush}"/>
                    </Viewbox>
                </Button>
            </Grid>

            <!-- Hidden automation/status elements preserved for E2E -->
            <TextBlock x:Name="StatusText" Visibility="Collapsed"/>
            <TextBlock x:Name="TranscriptText" Visibility="Collapsed" AutomationProperties.AutomationId="TranscriptText"/>
        </Grid>
    </Border>
</Window>
